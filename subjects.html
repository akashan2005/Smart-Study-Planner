<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Study Planner - Subjects & Notes</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      color: #fff;
    }

    /* ===== Video Background ===== */
    #bgVideo {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      z-index: -1;
      object-fit: cover;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0,0,0,0.6);
      padding: 10px 20px;
    }

    .user-info {
      font-weight: bold;
    }

    .back-btn {
      color:#fff; 
      text-decoration:none; 
      font-weight:bold; 
      background:#9d4edd; 
      padding:6px 12px; 
      border-radius:6px;
      transition: all 0.2s ease;
    }
    .back-btn:hover {
      background:#7b36c9;
      transform: translateY(-1px);
    }

    .content {
      max-width: 900px;
      margin: 20px auto;
      background: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }

    .subject-input-container {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      gap: 10px;
    }

    .subject-input-container input {
      padding: 10px;
      border: none;
      border-radius: 6px;
      flex: 1;
    }

    .subject-input-container button {
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      background: #9d4edd;
      color: #fff;
      cursor: pointer;
    }

    .subject-bar {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 6px;
      margin-bottom: 20px;
    }

    .subject-tab {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 15px;
      background: rgba(255,255,255,0.2);
      border-radius: 6px;
      cursor: pointer;
      white-space: nowrap;
    }

    .subject-tab.active {
      background: #9d4edd;
      font-weight: bold;
    }

    .delete-btn {
      color: #ff6b6b;
      font-weight: bold;
      cursor: pointer;
      border: none;
      background: transparent;
      font-size: 16px;
    }

    .subject-section {
      display: none;
      text-align: left;
      margin-top: 20px;
    }

    .subject-section.active {
      display: block;
    }

    .toolbar {
      margin-bottom: 10px;
    }

    .toolbar button {
      background: #333;
      color: #fff;
      border: none;
      padding: 6px 10px;
      margin-right: 5px;
      cursor: pointer;
      border-radius: 4px;
      font-size: 14px;
    }

    .notes-editor {
      width: 100%;
      min-height: 150px;
      padding: 10px;
      border-radius: 6px;
      border: none;
      background: #fff;
      color: #000;
      outline: none;
    }

    .file-upload-container {
      margin-top: 15px;
    }

    label {
      font-weight: bold;
    }
  </style>
</head>
<body>

  <!-- Video Background -->
  <video autoplay muted loop id="bgVideo">
    <source src="Page.mp4" type="video/mp4">
    Your browser does not support HTML5 video.
  </video>

  <!-- Header -->
  <div class="header" id="header">
    <div class="user-info">Welcome, <span id="userName"></span>!</div>
    <a href="dashboard.html" class="back-btn">‚Üê Back to Home</a>
  </div>

  <!-- Main Content -->
  <div class="content" id="content">
    <h1>Subjects & Notes</h1>

    <!-- Add Subject -->
    <div class="subject-input-container">
      <input type="text" id="newSubjectInput" placeholder="Enter subject name...">
      <button onclick="addSubject()">Add Subject</button>
    </div>

    <!-- Subject Tabs -->
    <div class="subject-bar" id="subjectBar"></div>

    <!-- Subject Sections -->
    <div id="subjectsContainer"></div>
  </div>

  <script>
    const subjectBar = document.getElementById('subjectBar');
    const subjectsContainer = document.getElementById('subjectsContainer');
    const userNameEl = document.getElementById('userName');

    document.addEventListener('DOMContentLoaded', () => {
      const username = localStorage.getItem('planner_username');
      if (username) { userNameEl.textContent = username; }

      loadSubjects();
    });

    function addSubject() {
      const input = document.getElementById('newSubjectInput');
      const subjectName = input.value.trim();
      if (subjectName === '') return;

      const subjects = JSON.parse(localStorage.getItem('planner_subjects')) || [];
      const newSubject = { id: Date.now(), name: subjectName, notes: '' };
      subjects.push(newSubject);
      localStorage.setItem('planner_subjects', JSON.stringify(subjects));

      displaySubject(newSubject);
      input.value = '';
    }

    function displaySubject(subject) {
      // Create tab with delete button
      const tab = document.createElement('div');
      tab.className = 'subject-tab';
      tab.innerHTML = `
        <span class="tab-name">${subject.name}</span>
        <button class="delete-btn" onclick="deleteSubject(${subject.id})">&times;</button>
      `;
      tab.querySelector('.tab-name').onclick = () => showSubject(subject.id);
      subjectBar.appendChild(tab);

      // Create section
      const section = document.createElement('div');
      section.className = 'subject-section';
      section.id = `subject-${subject.id}`;
      section.innerHTML = `
        <h2>${subject.name}</h2>
        <div class="toolbar">
          <button onclick="formatText('bold')"><b>B</b></button>
          <button onclick="formatText('italic')"><i>I</i></button>
          <button onclick="formatText('underline')"><u>U</u></button>
        </div>
        <div class="notes-editor" contenteditable="true" oninput="saveNotes(${subject.id}, this.innerHTML)">
          ${subject.notes || ''}
        </div>
        <div class="file-upload-container">
          <label for="file-${subject.id}">Upload Files:</label>
          <input type="file" id="file-${subject.id}">
        </div>
      `;
      subjectsContainer.appendChild(section);

      if (subjectBar.children.length === 1) {
        showSubject(subject.id); // auto-show first subject
      }
    }

    function showSubject(id) {
      Array.from(subjectBar.children).forEach(tab => tab.classList.remove('active'));
      Array.from(subjectsContainer.children).forEach(sec => sec.classList.remove('active'));

      const subject = getSubjectById(id);
      if (!subject) return;
      const tab = Array.from(subjectBar.children).find(t => t.querySelector('.tab-name').textContent === subject.name);
      if (tab) tab.classList.add('active');
      const section = document.getElementById(`subject-${id}`);
      if (section) section.classList.add('active');
    }

    function saveNotes(id, value) {
      const subjects = JSON.parse(localStorage.getItem('planner_subjects')) || [];
      const index = subjects.findIndex(s => s.id === id);
      if (index !== -1) {
        subjects[index].notes = value;
        localStorage.setItem('planner_subjects', JSON.stringify(subjects));
      }
    }

    function getSubjectById(id) {
      const subjects = JSON.parse(localStorage.getItem('planner_subjects')) || [];
      return subjects.find(s => s.id === id);
    }

    function deleteSubject(id) {
      if (!confirm("Are you sure you want to delete this subject?")) return;
      let subjects = JSON.parse(localStorage.getItem('planner_subjects')) || [];
      subjects = subjects.filter(s => s.id !== id);
      localStorage.setItem('planner_subjects', JSON.stringify(subjects));

      const section = document.getElementById(`subject-${id}`);
      if (section) section.remove();
      const tab = Array.from(subjectBar.children).find(t => t.innerHTML.includes(`deleteSubject(${id})`));
      if (tab) tab.remove();

      if (subjects.length > 0) {
        showSubject(subjects[0].id);
      }
    }

    function loadSubjects() {
      const subjects = JSON.parse(localStorage.getItem('planner_subjects')) || [];
      subjects.forEach(subject => displaySubject(subject));
    }

    function formatText(command) {
      document.execCommand(command, false, null);
    }
  </script>
</body>
</html>
